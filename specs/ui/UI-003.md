# UI-003: Artifact Management UI

## Metadata
- **ID**: UI-003
- **Created**: 2025-12-27
- **Status**: Approved
- **Priority**: High
- **Related Backend**: FEAT-004 (Artifact Management)
- **Related APIs**: API-005

## Overview
Claude Agentê°€ ìƒì„±í•œ ì•„í‹°íŒ©íŠ¸ë¥¼ ì¡°íšŒ, ë‹¤ìš´ë¡œë“œ, ê´€ë¦¬í•˜ëŠ” UIë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
FEAT-004ì˜ ë°±ì—”ë“œ ê¸°ëŠ¥ê³¼ í•¨ê»˜ êµ¬í˜„ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

## Feature Pairing (Backend-Frontend)

| Backend (FEAT-004) | Frontend (UI-003) |
|-------------------|-------------------|
| REQ-1: Artifact Upload | ì—…ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ |
| REQ-3: Artifact Metadata | ë©”íƒ€ë°ì´í„° í‘œì‹œ |
| REQ-4: Artifact Download | ë‹¤ìš´ë¡œë“œ ë²„íŠ¼/Presigned URL |
| REQ-5: Artifact Lifecycle | ìƒíƒœ í‘œì‹œ (Active/Archived) |
| REQ-8: Artifact Types | íƒ€ì…ë³„ ì•„ì´ì½˜/ë¯¸ë¦¬ë³´ê¸° |

## Requirements

### REQ-1: Artifact List in Execution Detail
- [ ] ì‹¤í–‰ ìƒì„¸ í˜ì´ì§€ ë‚´ ì•„í‹°íŒ©íŠ¸ íƒ­
- [ ] íŒŒì¼ ëª©ë¡ í…Œì´ë¸”
  - íŒŒì¼ëª… (ì•„ì´ì½˜ í¬í•¨)
  - íŒŒì¼ í¬ê¸°
  - íƒ€ì…
  - ìƒì„± ì‹œê°„
  - ìƒíƒœ
  - ì•¡ì…˜ (ë‹¤ìš´ë¡œë“œ, ë¯¸ë¦¬ë³´ê¸°, ì‚­ì œ)
- [ ] íƒ€ì…ë³„ í•„í„°ë§
- [ ] ì¼ê´„ ë‹¤ìš´ë¡œë“œ (ZIP)

### REQ-2: Artifact Type Icons & Preview
```typescript
const ARTIFACT_TYPE_CONFIG = {
  code: {
    icon: 'Code',
    color: 'purple',
    extensions: ['.ts', '.js', '.py', '.go', '.java', '.rs'],
    preview: 'syntax-highlight',
  },
  document: {
    icon: 'FileText',
    color: 'blue',
    extensions: ['.md', '.txt', '.pdf', '.doc'],
    preview: 'markdown-render',
  },
  image: {
    icon: 'Image',
    color: 'green',
    extensions: ['.png', '.jpg', '.jpeg', '.gif', '.svg'],
    preview: 'image-viewer',
  },
  data: {
    icon: 'Database',
    color: 'orange',
    extensions: ['.json', '.csv', '.xml', '.yaml'],
    preview: 'json-viewer',
  },
  log: {
    icon: 'Terminal',
    color: 'gray',
    extensions: ['.log'],
    preview: 'log-viewer',
  },
  other: {
    icon: 'File',
    color: 'gray',
    extensions: [],
    preview: null,
  },
};
```

### REQ-3: File Preview Modal
- [ ] ì½”ë“œ íŒŒì¼: êµ¬ë¬¸ ê°•ì¡° (Prism.js / Shiki)
- [ ] ë§ˆí¬ë‹¤ìš´: ë Œë”ë§ëœ ë§ˆí¬ë‹¤ìš´
- [ ] ì´ë¯¸ì§€: ì´ë¯¸ì§€ ë·°ì–´ (í™•ëŒ€/ì¶•ì†Œ)
- [ ] JSON: íŠ¸ë¦¬ ë·°ì–´ (ì ‘ê¸°/í¼ì¹˜ê¸°)
- [ ] CSV: í…Œì´ë¸” ë·°ì–´
- [ ] ë¡œê·¸: ë¡œê·¸ ë·°ì–´ (ì¤„ ë²ˆí˜¸, ê²€ìƒ‰)
- [ ] ê¸°íƒ€: ë‹¤ìš´ë¡œë“œ ìœ ë„

### REQ-4: Artifact Browser Page
- [ ] ì „ì²´ ì•„í‹°íŒ©íŠ¸ ëª©ë¡ í˜ì´ì§€ (ì‹¤í–‰ê³¼ ë…ë¦½)
- [ ] ì‹¤í–‰ IDë³„ ê·¸ë£¹í•‘ ì˜µì…˜
- [ ] íŒŒì¼ íƒ€ì…ë³„ í•„í„°
- [ ] ë‚ ì§œ ë²”ìœ„ í•„í„°
- [ ] íŒŒì¼ëª… ê²€ìƒ‰
- [ ] ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰ í‘œì‹œ

### REQ-5: Download Features
- [ ] ê°œë³„ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
- [ ] Presigned URL ë°©ì‹ (ëŒ€ìš©ëŸ‰ íŒŒì¼)
- [ ] ì‹¤í–‰ë³„ ì „ì²´ ë‹¤ìš´ë¡œë“œ (ZIP)
- [ ] ì„ íƒ íŒŒì¼ ì¼ê´„ ë‹¤ìš´ë¡œë“œ
- [ ] ë‹¤ìš´ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ

### REQ-6: Upload Progress (Agent ì‹¤í–‰ ì¤‘)
- [ ] ì‹¤ì‹œê°„ ì—…ë¡œë“œ ìƒíƒœ í‘œì‹œ
- [ ] ì—…ë¡œë“œ ì§„í–‰ë¥  ë°”
- [ ] ì—…ë¡œë“œ ì™„ë£Œ ì•Œë¦¼

### REQ-7: Lifecycle Management
- [ ] ë§Œë£Œ ì˜ˆì • ì•„í‹°íŒ©íŠ¸ í‘œì‹œ
- [ ] ì˜êµ¬ ë³´ì¡´ ì„¤ì •
- [ ] ìˆ˜ë™ ì‚­ì œ (í™•ì¸ ëª¨ë‹¬)
- [ ] ì•„ì¹´ì´ë¸Œëœ íŒŒì¼ ë³µì› ìš”ì²­

## Page Routes

| Route | Page | Description |
|-------|------|-------------|
| `/executions/[id]?tab=artifacts` | ExecutionDetailPage | ì‹¤í–‰ ë‚´ ì•„í‹°íŒ©íŠ¸ |
| `/artifacts` | ArtifactBrowserPage | ì•„í‹°íŒ©íŠ¸ ë¸Œë¼ìš°ì € |
| `/artifacts/[id]` | ArtifactDetailPage | ì•„í‹°íŒ©íŠ¸ ìƒì„¸ |

## Components Structure

```
src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ artifacts/
â”‚       â”œâ”€â”€ page.tsx              # ì•„í‹°íŒ©íŠ¸ ë¸Œë¼ìš°ì €
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ page.tsx          # ì•„í‹°íŒ©íŠ¸ ìƒì„¸
â”œâ”€â”€ components/
â”‚   â””â”€â”€ artifacts/
â”‚       â”œâ”€â”€ ArtifactList.tsx      # ëª©ë¡ í…Œì´ë¸”
â”‚       â”œâ”€â”€ ArtifactCard.tsx      # ì¹´ë“œ ë·°
â”‚       â”œâ”€â”€ ArtifactIcon.tsx      # íƒ€ì…ë³„ ì•„ì´ì½˜
â”‚       â”œâ”€â”€ ArtifactPreview.tsx   # ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬
â”‚       â”œâ”€â”€ ArtifactFilters.tsx   # í•„í„°
â”‚       â”œâ”€â”€ ArtifactActions.tsx   # ì•¡ì…˜ ë²„íŠ¼
â”‚       â”œâ”€â”€ DownloadButton.tsx    # ë‹¤ìš´ë¡œë“œ
â”‚       â”œâ”€â”€ UploadProgress.tsx    # ì—…ë¡œë“œ ì§„í–‰ë¥ 
â”‚       â””â”€â”€ previews/
â”‚           â”œâ”€â”€ CodePreview.tsx   # ì½”ë“œ ë¯¸ë¦¬ë³´ê¸°
â”‚           â”œâ”€â”€ ImagePreview.tsx  # ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
â”‚           â”œâ”€â”€ JsonPreview.tsx   # JSON ë·°ì–´
â”‚           â”œâ”€â”€ CsvPreview.tsx    # CSV í…Œì´ë¸”
â”‚           â”œâ”€â”€ MarkdownPreview.tsx # ë§ˆí¬ë‹¤ìš´
â”‚           â””â”€â”€ LogPreview.tsx    # ë¡œê·¸ ë·°ì–´
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ artifacts/
â”‚       â”œâ”€â”€ useArtifacts.ts       # ëª©ë¡ ì¡°íšŒ
â”‚       â”œâ”€â”€ useArtifact.ts        # ë‹¨ì¼ ì¡°íšŒ
â”‚       â”œâ”€â”€ useDownload.ts        # ë‹¤ìš´ë¡œë“œ
â”‚       â””â”€â”€ usePreview.ts         # ë¯¸ë¦¬ë³´ê¸° ë°ì´í„°
â””â”€â”€ services/
    â””â”€â”€ artifactApi.ts            # API í´ë¼ì´ì–¸íŠ¸
```

## API Integration

```typescript
// services/artifactApi.ts
export const artifactApi = {
  // GET /api/v1/executions/:executionId/artifacts
  listByExecution: (executionId: string): Promise<ArtifactMetadata[]> =>
    api.get(`/executions/${executionId}/artifacts`),

  // GET /api/v1/artifacts
  list: (filter?: ArtifactFilter): Promise<PaginatedResponse<ArtifactMetadata>> =>
    api.get('/artifacts', { params: filter }),

  // GET /api/v1/artifacts/:id
  get: (id: string): Promise<ArtifactMetadata> =>
    api.get(`/artifacts/${id}`),

  // GET /api/v1/artifacts/:id/download
  getDownloadUrl: (id: string, expiresIn?: number): Promise<{ url: string }> =>
    api.get(`/artifacts/${id}/download`, { params: { expiresIn } }),

  // GET /api/v1/artifacts/:id/content (í”„ë¡ì‹œ)
  getContent: (id: string): Promise<Blob> =>
    api.get(`/artifacts/${id}/content`, { responseType: 'blob' }),

  // GET /api/v1/artifacts/:id/preview (í…ìŠ¤íŠ¸ íŒŒì¼ìš©)
  getPreview: (id: string): Promise<{ content: string; truncated: boolean }> =>
    api.get(`/artifacts/${id}/preview`),

  // DELETE /api/v1/artifacts/:id
  delete: (id: string): Promise<void> =>
    api.delete(`/artifacts/${id}`),

  // POST /api/v1/executions/:executionId/artifacts/download-all
  downloadAll: (executionId: string): Promise<{ url: string }> =>
    api.post(`/executions/${executionId}/artifacts/download-all`),

  // PATCH /api/v1/artifacts/:id/permanent
  setPermanent: (id: string, permanent: boolean): Promise<void> =>
    api.patch(`/artifacts/${id}/permanent`, { permanent }),
};
```

## Preview Component Example

```typescript
// components/artifacts/ArtifactPreview.tsx
import { Dialog } from '@/components/ui/dialog';
import { CodePreview } from './previews/CodePreview';
import { ImagePreview } from './previews/ImagePreview';
import { JsonPreview } from './previews/JsonPreview';

interface ArtifactPreviewProps {
  artifact: ArtifactMetadata;
  open: boolean;
  onClose: () => void;
}

export function ArtifactPreview({ artifact, open, onClose }: ArtifactPreviewProps) {
  const PreviewComponent = getPreviewComponent(artifact.type);

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <Dialog.Content className="max-w-4xl max-h-[80vh]">
        <Dialog.Header>
          <Dialog.Title>{artifact.fileName}</Dialog.Title>
          <div className="text-sm text-muted-foreground">
            {formatFileSize(artifact.fileSize)} Â· {artifact.mimeType}
          </div>
        </Dialog.Header>

        <div className="overflow-auto">
          {PreviewComponent ? (
            <PreviewComponent artifactId={artifact.id} />
          ) : (
            <div className="text-center py-8">
              <p>ë¯¸ë¦¬ë³´ê¸°ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.</p>
              <DownloadButton artifactId={artifact.id} />
            </div>
          )}
        </div>

        <Dialog.Footer>
          <DownloadButton artifactId={artifact.id} variant="primary" />
          <Button variant="ghost" onClick={onClose}>ë‹«ê¸°</Button>
        </Dialog.Footer>
      </Dialog.Content>
    </Dialog>
  );
}
```

## File Size Formatting

```typescript
export function formatFileSize(bytes: number): string {
  const units = ['B', 'KB', 'MB', 'GB'];
  let size = bytes;
  let unitIndex = 0;

  while (size >= 1024 && unitIndex < units.length - 1) {
    size /= 1024;
    unitIndex++;
  }

  return `${size.toFixed(unitIndex > 0 ? 1 : 0)} ${units[unitIndex]}`;
}
```

## Artifact List Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Artifacts                                    [Download All] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filter: [All Types â–¼] [Date Range] [Search...        ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ â”‚ Icon â”‚ File Name        â”‚ Size    â”‚ Type   â”‚ Actions   â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ â”‚ ğŸ“„   â”‚ output.py        â”‚ 2.3 KB  â”‚ code   â”‚ ğŸ‘ â¬‡ ğŸ—‘   â”‚
â”‚ â˜ â”‚ ğŸ“Š   â”‚ data.json        â”‚ 15.2 KB â”‚ data   â”‚ ğŸ‘ â¬‡ ğŸ—‘   â”‚
â”‚ â˜ â”‚ ğŸ–¼   â”‚ screenshot.png   â”‚ 234 KB  â”‚ image  â”‚ ğŸ‘ â¬‡ ğŸ—‘   â”‚
â”‚ â˜ â”‚ ğŸ“   â”‚ README.md        â”‚ 1.1 KB  â”‚ doc    â”‚ ğŸ‘ â¬‡ ğŸ—‘   â”‚
â”‚ â˜ â”‚ ğŸ“‹   â”‚ agent.log        â”‚ 45.6 KB â”‚ log    â”‚ ğŸ‘ â¬‡ ğŸ—‘   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Selected: 2 files (17.5 KB)              [Download Selected]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Verification Criteria

- [ ] ì•„í‹°íŒ©íŠ¸ ëª©ë¡ì´ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë¨
- [ ] íƒ€ì…ë³„ ì•„ì´ì½˜ì´ ì •í™•í•¨
- [ ] íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°ê°€ ê° íƒ€ì…ë³„ë¡œ ë™ì‘í•¨
- [ ] ê°œë³„/ì¼ê´„ ë‹¤ìš´ë¡œë“œê°€ ë™ì‘í•¨
- [ ] Presigned URLì´ ì˜¬ë°”ë¥´ê²Œ ìƒì„±ë¨
- [ ] ì‚­ì œ ë° ì˜êµ¬ ë³´ì¡´ ì„¤ì •ì´ ë™ì‘í•¨
- [ ] í•„í„°ë§ ë° ê²€ìƒ‰ì´ ë™ì‘í•¨

## Related Specs

- **Backend**: FEAT-004 (Artifact Management)
- **APIs**: API-005
- **Related UI**: UI-001 (Execution UI), UI-004 (Common Layout)

---

## Change History

| Date | Author | Description |
|------|--------|-------------|
| 2025-12-27 | Claude | Initial creation |
