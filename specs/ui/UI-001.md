# UI-001: Execution Management UI

## Metadata
- **ID**: UI-001
- **Created**: 2025-12-27
- **Status**: Approved
- **Priority**: High
- **Related Backend**: FEAT-002 (Agent Execution Management)
- **Related APIs**: API-001, API-002, API-004

## Overview
Claude Agent 실행을 생성, 조회, 관리하는 프론트엔드 UI를 정의합니다.
FEAT-002의 백엔드 기능과 함께 구현되어야 합니다.

## Feature Pairing (Backend-Frontend)

| Backend (FEAT-002) | Frontend (UI-001) |
|-------------------|-------------------|
| REQ-1: Agent Job Creation | 실행 생성 폼 |
| REQ-3: Job Lifecycle Management | 실행 상태 표시 및 취소 버튼 |
| REQ-4: Execution States | 상태별 아이콘/색상 표시 |
| REQ-5: Execution Request Schema | 폼 필드 및 유효성 검증 |
| REQ-6: Execution Response Schema | 실행 상세 정보 표시 |

## Requirements

### REQ-1: Execution Creation Form
- [ ] 프롬프트 입력 (필수, 텍스트 에어리어)
- [ ] 모델 선택 (드롭다운, 기본값: claude-sonnet-4-20250514)
- [ ] 최대 토큰 설정 (숫자 입력, 기본값: 4096)
- [ ] 타임아웃 설정 (숫자 입력, 기본값: 1800초)
- [ ] 고급 옵션 토글 (리소스 설정)
  - Memory Request/Limit
  - CPU Request/Limit
- [ ] 메타데이터 입력 (키-값 쌍, 동적 추가/삭제)
- [ ] 폼 유효성 검증 및 에러 표시
- [ ] 제출 버튼 및 로딩 상태

### REQ-2: Execution List Page
- [ ] 테이블 형식 목록 표시
  - ID (클릭 시 상세로 이동)
  - 상태 (아이콘 + 텍스트)
  - 프롬프트 (truncated)
  - 모델
  - 생성 시간
  - 실행 시간
- [ ] 상태별 필터링 (PENDING, RUNNING, COMPLETED, FAILED, CANCELLED)
- [ ] 날짜 범위 필터
- [ ] 검색 (프롬프트 내용)
- [ ] 페이지네이션 (페이지 크기 선택: 10, 20, 50)
- [ ] 정렬 (생성일, 상태)
- [ ] 새로고침 버튼
- [ ] 실행 중인 항목 자동 갱신 (polling 또는 WebSocket)

### REQ-3: Execution Detail Page
- [ ] 실행 기본 정보
  - ID, 상태, 모델, 토큰 설정
  - 생성/시작/완료 시간
  - Job/Pod 이름
- [ ] 상태별 UI 분기
  - PENDING: 대기 중 표시
  - RUNNING: 실시간 상태 갱신, 취소 버튼
  - COMPLETED: 결과 출력 표시, 토큰 사용량
  - FAILED: 에러 정보 표시
  - CANCELLED: 취소 정보 표시
- [ ] 실행 취소 버튼 (PENDING, RUNNING 상태에서만)
- [ ] 로그 뷰어 탭 (실시간 로그 스트리밍)
- [ ] 아티팩트 목록 탭 (UI-003과 연동)
- [ ] 재실행 버튼 (동일 설정으로 새 실행 생성)

### REQ-4: Execution Status Display
```typescript
const STATUS_CONFIG = {
  PENDING: {
    icon: 'Clock',
    color: 'gray',
    label: '대기 중',
    bgColor: 'bg-gray-100',
  },
  RUNNING: {
    icon: 'Loader',
    color: 'blue',
    label: '실행 중',
    bgColor: 'bg-blue-100',
    animate: true,
  },
  COMPLETED: {
    icon: 'CheckCircle',
    color: 'green',
    label: '완료',
    bgColor: 'bg-green-100',
  },
  FAILED: {
    icon: 'XCircle',
    color: 'red',
    label: '실패',
    bgColor: 'bg-red-100',
  },
  CANCELLED: {
    icon: 'Ban',
    color: 'orange',
    label: '취소됨',
    bgColor: 'bg-orange-100',
  },
};
```

### REQ-5: Real-time Updates
- [ ] 실행 중인 항목 상태 자동 갱신
- [ ] 방법 선택: Polling (5초) 또는 WebSocket/SSE
- [ ] 상태 변경 시 토스트 알림
- [ ] 네트워크 오류 시 재연결 로직

## Page Routes

| Route | Page | Description |
|-------|------|-------------|
| `/executions` | ExecutionListPage | 실행 목록 |
| `/executions/new` | ExecutionCreatePage | 새 실행 생성 |
| `/executions/[id]` | ExecutionDetailPage | 실행 상세 |

## Components Structure

```
src/
├── app/
│   └── executions/
│       ├── page.tsx              # 실행 목록
│       ├── new/
│       │   └── page.tsx          # 실행 생성
│       └── [id]/
│           └── page.tsx          # 실행 상세
├── components/
│   └── executions/
│       ├── ExecutionForm.tsx     # 생성 폼
│       ├── ExecutionList.tsx     # 목록 테이블
│       ├── ExecutionCard.tsx     # 카드 뷰 (선택)
│       ├── ExecutionDetail.tsx   # 상세 정보
│       ├── ExecutionStatus.tsx   # 상태 배지
│       ├── ExecutionFilters.tsx  # 필터 컴포넌트
│       ├── ExecutionLogs.tsx     # 로그 뷰어
│       └── ExecutionActions.tsx  # 액션 버튼들
├── hooks/
│   └── executions/
│       ├── useExecutions.ts      # 목록 조회 훅
│       ├── useExecution.ts       # 단일 조회 훅
│       ├── useCreateExecution.ts # 생성 훅
│       └── useCancelExecution.ts # 취소 훅
└── services/
    └── executionApi.ts           # API 클라이언트
```

## API Integration

```typescript
// services/executionApi.ts
import { api } from '@/lib/api';
import type {
  ExecutionRequest,
  ExecutionResponse,
  ExecutionFilter,
  PaginatedResponse,
} from '@claude-agent/shared';

export const executionApi = {
  // POST /api/v1/executions (API-001)
  create: (data: ExecutionRequest): Promise<ExecutionResponse> =>
    api.post('/executions', data),

  // GET /api/v1/executions/:id (API-002)
  get: (id: string): Promise<ExecutionResponse> =>
    api.get(`/executions/${id}`),

  // GET /api/v1/executions (API-003)
  list: (filter?: ExecutionFilter): Promise<PaginatedResponse<ExecutionResponse>> =>
    api.get('/executions', { params: filter }),

  // POST /api/v1/executions/:id/cancel (API-004)
  cancel: (id: string): Promise<void> =>
    api.post(`/executions/${id}/cancel`),

  // GET /api/v1/executions/:id/logs
  getLogs: (id: string, options?: LogOptions): Promise<string> =>
    api.get(`/executions/${id}/logs`, { params: options }),
};
```

## Form Validation Schema

```typescript
// Zod schema for execution form
import { z } from 'zod';

export const executionFormSchema = z.object({
  prompt: z.string().min(1, '프롬프트를 입력해주세요').max(100000),
  model: z.string().default('claude-sonnet-4-20250514'),
  maxTokens: z.number().min(1).max(100000).default(4096),
  timeout: z.number().min(60).max(3600).default(1800),
  callbackUrl: z.string().url().optional().or(z.literal('')),
  metadata: z.record(z.string()).optional(),
  resources: z.object({
    memoryRequest: z.string().optional(),
    memoryLimit: z.string().optional(),
    cpuRequest: z.string().optional(),
    cpuLimit: z.string().optional(),
  }).optional(),
});

export type ExecutionFormData = z.infer<typeof executionFormSchema>;
```

## UI/UX Guidelines

- **로딩 상태**: Skeleton UI 사용
- **에러 상태**: 인라인 에러 메시지 + 토스트 알림
- **빈 상태**: 실행이 없을 때 CTA 버튼 포함 안내 메시지
- **반응형**: 모바일에서는 카드 뷰, 데스크톱에서는 테이블 뷰
- **접근성**: ARIA 레이블, 키보드 네비게이션 지원

## Verification Criteria

- [ ] 실행 생성 폼이 모든 필드를 올바르게 전송함
- [ ] 목록 페이지에서 필터링, 정렬, 페이지네이션 동작
- [ ] 상세 페이지에서 상태별 UI가 올바르게 표시됨
- [ ] 실행 취소가 정상 동작함
- [ ] 실시간 상태 갱신이 동작함
- [ ] 폼 유효성 검증이 올바르게 동작함

## Related Specs

- **Backend**: FEAT-002 (Agent Execution Management)
- **APIs**: API-001, API-002, API-003, API-004
- **Related UI**: UI-003 (Artifact UI), UI-004 (Common Layout)

---

## Change History

| Date | Author | Description |
|------|--------|-------------|
| 2025-12-27 | Claude | Initial creation |
