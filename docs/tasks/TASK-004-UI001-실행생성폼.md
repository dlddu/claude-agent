# TASK-004: UI-001 실행 생성 폼 구현

## 메타데이터
- **작성일**: 2026-01-03
- **완료일**: 2026-01-03
- **예상 크기**: M (2-4시간)
- **상태**: ✅ 완료
- **관련 스토리**: US (Phase 2 - 실행 생성)
- **관련 인수 테스트**: UI-001 REQ-1

## 작업 목표

이 작업을 완료하면 다음 기능이 동작합니다:
- [x] 프롬프트 입력 (필수, 텍스트 에어리어)
- [x] 모델 선택 (드롭다운)
- [x] 최대 토큰 설정 (숫자 입력)
- [x] 타임아웃 설정 (숫자 입력)
- [x] 고급 옵션 (리소스 설정)
- [x] 메타데이터 입력 (키-값 쌍)
- [x] 폼 유효성 검증 및 에러 표시
- [x] 제출 버튼 및 로딩 상태

## 구현 범위

### 구현할 기능
1. **ExecutionForm 컴포넌트**
   - `src/components/executions/ExecutionForm.tsx`
   - Zod 스키마 기반 유효성 검증
   - react-hook-form 연동

2. **폼 필드 컴포넌트**
   - 프롬프트 TextArea
   - 모델 Select
   - 숫자 입력 필드 (토큰, 타임아웃)
   - 고급 옵션 Collapsible
   - 메타데이터 KeyValue Editor

3. **페이지 구현**
   - `src/app/executions/new/page.tsx` 완성

### 작성할 테스트
1. ExecutionForm 컴포넌트 테스트
   - 필수 필드 유효성 검증
   - 폼 제출 동작
   - 에러 표시
2. E2E 테스트
   - 실행 생성 흐름

### 구현 제외 항목
- 실행 목록 페이지 (TASK-005)
- 실행 상세 페이지 (TASK-006)

## 기술적 접근 방법

1. **폼 라이브러리**
   - react-hook-form + Zod resolver
   - @hookform/resolvers/zod

2. **UI 컴포넌트**
   - 기존 UI 컴포넌트 활용 (Button, Input, Card)
   - 새 컴포넌트 생성 (Label, Textarea, Select)
   - Tailwind CSS 스타일링

3. **유효성 검증 스키마**
   ```typescript
   const executionFormSchema = z.object({
     prompt: z.string().min(1, 'Prompt is required').max(100000),
     model: z.string().min(1, 'Model is required'),
     maxTokens: z.number().min(1).max(100000),
     timeout: z.number().min(60).max(3600),
     callbackUrl: z.string().url().optional().or(z.literal('')),
     resources: z.object({...}).optional(),
   });
   ```

## 테스트 전략

### 단위 테스트
- `src/__tests__/components/executions/ExecutionForm.test.tsx`
- 15개 테스트 케이스:
  - 렌더링: 필수 필드, 기본값, 취소 버튼
  - 유효성 검증: 필수 필드 에러, 문자 수 표시
  - 폼 제출: API 호출, 성공 시 이동, onSuccess 콜백, 에러 표시
  - 고급 옵션: 토글 동작
  - 메타데이터: 추가/삭제, 제출 시 포함
  - 취소 동작

### 인수 테스트 실행 방법
```bash
pnpm --filter frontend test
```

## 완료 조건

이 작업은 다음 조건을 모두 만족할 때 완료됩니다:
1. [x] 폼이 모든 필드를 올바르게 렌더링
2. [x] 유효성 검증이 정상 동작
3. [x] API 호출 및 성공 시 상세 페이지로 이동
4. [x] 로딩 상태가 올바르게 표시
5. [x] 단위 테스트 작성 및 통과 (15/15)
6. [x] 빌드 성공 (로컬)

## 구현 결과

### 생성된 파일
- `packages/frontend/src/components/ui/Label.tsx` - Label 컴포넌트
- `packages/frontend/src/components/ui/Textarea.tsx` - Textarea 컴포넌트
- `packages/frontend/src/components/ui/Select.tsx` - Select 컴포넌트
- `packages/frontend/src/components/executions/ExecutionForm.tsx` - 실행 생성 폼
- `packages/frontend/src/__tests__/components/executions/ExecutionForm.test.tsx` - 테스트

### 수정된 파일
- `packages/frontend/src/app/executions/new/page.tsx` - ExecutionForm 통합
- `packages/frontend/package.json` - react-hook-form, zod, @hookform/resolvers 추가

### 테스트 결과
- 전체 테스트: 57개 통과
- ExecutionForm 테스트: 15개 통과

## 의존성

### 선행 작업
- TASK-003: UI-001 기본 구조 및 API 클라이언트 (✅ 완료)

### 후행 작업
- TASK-005: 실행 목록 페이지 구현

## 추적성
- **명세서**: UI-001 REQ-1
- **관련 API**: API-001 (Create Execution)
