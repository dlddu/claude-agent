# TASK-007: UI-001 실시간 업데이트 구현

## 메타데이터
- **작성일**: 2026-01-03
- **예상 크기**: M (2-4시간)
- **상태**: 계획됨
- **관련 스토리**: US (Phase 2 - 실시간 상태 업데이트)
- **관련 인수 테스트**: UI-001 REQ-5

## 작업 목표

이 작업을 완료하면 다음 기능이 동작합니다:
- [ ] 실행 중인 항목 상태 자동 갱신
- [ ] Polling (5초) 또는 SSE 방식 선택
- [ ] 상태 변경 시 토스트 알림
- [ ] 네트워크 오류 시 재연결 로직

## 구현 범위

### 구현할 기능
1. **실시간 업데이트 훅**
   - `src/hooks/executions/useExecutionPolling.ts`
   - 또는 `src/hooks/executions/useExecutionSSE.ts`

2. **상태 변경 알림**
   - 토스트 통합
   - 상태 전환 감지

3. **네트워크 처리**
   - 재연결 로직
   - 오프라인 감지

### 작성할 테스트
1. Polling/SSE 훅 테스트
2. 상태 변경 알림 테스트
3. E2E 테스트 - 실시간 업데이트

### 구현 제외 항목
- WebSocket 구현 (복잡도 높음, 추후 개선)

## 기술적 접근 방법

1. **Polling 방식 (권장)**
   ```typescript
   const useExecutionPolling = (id: string, enabled: boolean) => {
     return useQuery({
       queryKey: ['execution', id],
       queryFn: () => executionApi.get(id),
       refetchInterval: enabled ? 5000 : false,
       refetchIntervalInBackground: false,
     });
   };
   ```

2. **상태 변경 감지**
   ```typescript
   useEffect(() => {
     if (prevStatus && prevStatus !== status) {
       toast({
         title: `실행 상태 변경`,
         description: `${prevStatus} → ${status}`,
       });
     }
   }, [status]);
   ```

3. **자동 갱신 조건**
   - PENDING, RUNNING 상태에서만 활성화
   - COMPLETED, FAILED, CANCELLED에서는 비활성화

## 테스트 전략

### 단위 테스트
- `src/hooks/executions/__tests__/useExecutionPolling.test.tsx`
- Mock 타이머 활용

### E2E 테스트
- `e2e/tests/execution-realtime.spec.ts`
- 상태 변경 시나리오

### 인수 테스트 실행 방법
```bash
pnpm --filter frontend test
pnpm --filter e2e test
```

## 완료 조건

이 작업은 다음 조건을 모두 만족할 때 완료됩니다:
1. [ ] 실행 중 항목이 자동 갱신됨
2. [ ] 상태 변경 시 토스트 알림 표시
3. [ ] 완료된 항목은 갱신 중지
4. [ ] 네트워크 오류 시 적절한 처리
5. [ ] 단위 테스트 작성 및 통과
6. [ ] GitHub Actions CI 통과

## 의존성

### 선행 작업
- TASK-005: 실행 목록 페이지 구현
- TASK-006: 실행 상세 페이지 구현

### 후행 작업
- 없음 (UI-001 완료)

## 추적성
- **명세서**: UI-001 REQ-5
- **관련 API**: API-002 (Get Execution), API-003 (List Executions)
